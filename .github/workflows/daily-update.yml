name: Re-Entrenar IA Diariamente (Tenis + NBA)

on:
  # Se activa autom√°ticamente a las 8:00 AM hora espa√±ola aprox.
  schedule:
    - cron: '0 7 * * *'
  
  # Bot√≥n manual para ejecutarlo cuando quieras
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # 1. Trae tu c√≥digo del repositorio
      - name: 1. Checkout (Traer c√≥digo)
        uses: actions/checkout@v4

      # 2. Configura Python
      - name: 2. Configurar Python 3.12
        uses: actions/setup-python@v5
        with:
          python-version: '3.12' 

      # 3. Instala las librer√≠as (Aseg√∫rate de que requirements.txt incluya nba_api)
      - name: 3. Instalar librer√≠as
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          
      # 4. EJECUTA EL SCRIPT MAESTRO (Tenis + NBA)
      # Aqu√≠ es donde hacemos el cambio clave:
      - name: 4. Ejecutar Actualizaci√≥n Completa
        env:
          # Si ya no usas Kaggle puedes quitar estas dos l√≠neas, 
          # pero si las dejas no pasa nada.
          KAGGLE_JSON: ${{ secrets.KAGGLE_JSON }}
        run: python actualizar_todo.py
          
      # 5. Sube los resultados de vuelta a GitHub
      - name: 5. Subir (Commit) archivos nuevos
        run: |
          git config --global user.name "IA Bot"
          git config --global user.email "bot@github.com"
          git add .
          # El '|| echo' evita que falle si no hubo partidos nuevos ese d√≠a
          git diff-index --quiet HEAD || git commit -m "ü§ñ [Auto] IA Tenis y NBA re-entrenada con √©xito"
          git push
